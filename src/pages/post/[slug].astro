---
import Markdown from 'react-markdown'
import { getAllPosts, getSiteConfig } from "../../constants/queries.js"
import Layout from "../../layouts/Layout.astro";
import Card from "../../components/card/card.jsx";
import ContentBlock from "../../components/content-block/content-block.jsx";
import LayoutHeader from "../../components/header/header.jsx";
import PostLayout from "../../components/post-layout/post-layout.jsx";

export async function getStaticPaths() {
  const posts = await getAllPosts()
  const siteConfig = await getSiteConfig()
  // Loop over them and get the content
  return posts.map(({ slug, ...props }) => {
    return {
      params: { slug: slug.current },
      props: {
        ...props,
        siteConfig: siteConfig[0],
      },
    };
  });
}

const { slug } = Astro.params
const { description, title, post, body } = Astro.props

const shareLink = `https://twitter.com/intent/tweet?text=${encodeURIComponent(`"${title}" via @jh3yy\n`)}https://jhey.dev/post/${slug}/`

---
<Layout
  title={title}
  description={description}
  ogtitle={Astro.props?.og?.title}
  oghue={Astro.props?.og?.hue}
  oggradient={Astro.props?.og?.gradient}
  flexLayout={Astro.props._type === 'cheep'}
>
  <PostLayout {...Astro.props} {...Astro.params} shareLink={shareLink} />
</Layout>