---
import Layout from "../../layouts/Layout.astro";
import FeedLayout from "../../components/feed-layout/feed-layout.jsx";
import { getSiteConfig, getAllCheeps } from '../../constants/queries.js'
import { getRoutes } from '../../constants/routes.js'

export async function getStaticPaths({ paginate }) {
  const { PAGINATION_SIZE } = import.meta.env
  const pageSize = parseInt(PAGINATION_SIZE, 10)
  
  const allCheeps = await getAllCheeps()
  const siteConfig = await getSiteConfig()
  
  return paginate(allCheeps, { pageSize, props: {
    character: siteConfig.character,
    banner: siteConfig.banner,
  } })
}

const { banner, character, page } = Astro.props
---

<Layout
  title="Jhey Tompkins"
  ogtitle="Posts from Jhey Tompkins"
  description="Thoughts and creations from the mind of Jhey Tompkins"
  oggradient="2"
>
  <FeedLayout
    character={character}
    banner={banner}
    posts={page.data}
    currentPage={page.currentPage}
    totalPages={page.lastPage}
    route="/posts"
    navItems={getRoutes()}
  />
</Layout>