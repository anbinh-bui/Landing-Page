---
import FeedLayout from "../../layouts/Feed.astro";
import { getAllCheeps } from '../../constants/queries.js'
import { ROUTES } from '../../constants/routes.js'

export async function getStaticPaths({ paginate }) {
  const { PAGINATION_SIZE } = import.meta.env
  const pageSize = parseInt(PAGINATION_SIZE, 10)
  const allCheeps = await getAllCheeps()
  return paginate(allCheeps, { pageSize })
}

const page = {
  ...Astro.props.page,
  totalPages: Astro.props.page.lastPage,
  posts: Astro.props.page.data,
  route: ROUTES.posts.href,
}
---
<FeedLayout
  title="The Feed"
  description="Thoughts and creations from the mind of Jhey Tompkins"
  ogtitle="Posts from Jhey Tompkins"
  oggradient="2"
  page={page}
/>