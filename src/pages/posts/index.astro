---
import Layout from "../../layouts/Layout.astro";
import FeedLayout from "../../components/feed-layout/feed-layout.jsx";
import { getAllCheeps, getSiteConfig } from '../../constants/queries.js'

const { PAGINATION_SIZE } = import.meta.env
const pageSize = parseInt(PAGINATION_SIZE, 10)

const allCheeps = await getAllCheeps()
const siteConfig = await getSiteConfig()

const page = {
  banner: siteConfig[0].banner,
  character: siteConfig[0].character,
  data: allCheeps.slice(0, pageSize),
  currentPage: 1,
  lastPage: Math.ceil(allCheeps.length / pageSize),
}
---
<Layout
  title="Jhey Tompkins"
  ogtitle="Posts from Jhey Tompkins"
  description="Thoughts and creations from the mind of Jhey Tompkins"
  oggradient="2"
>
  <FeedLayout
    character={page.character}
    banner={page.banner}
    posts={page.data}
    currentPage={page.currentPage}
    totalPages={page.lastPage}
    route="/posts"
  />
</Layout>